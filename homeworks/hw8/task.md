## HW 8

### Описание
Требуется обучить модель, которая будет генерировать стикеры в вашем стиле. Для этого нужно обучить LoRA для Stable Diffusion 2.1;

### Данные
Данные нужно подготовить самостоятельно
* 20-50 или более картинок стикеров в вашем стиле
* Описание к каждой картинке. Оно должно быть индивидуально для каждой картинки, не очень длинное (до 77 токенов, т.к. CLIP поддерживает только 77 токенов) и не очень кортокое. Описание должно описывать содержимое картинки, указывать, что это стикер и в каком стиле этот стикер. Описание обязательно должно содержать выбранное вами ключевое слово key_word. Если сомневаетесь, спросите у ChatGPT как правильно составить описание и key_word


### Задача
* Найти подходящие вам стикеры или сгенерировать их какой-нибудь моделью или LLM-кой;
* Сгененировать описание для каждого стикера;
* Обучить LoRA, которая будет генерировать ваши стикеры; Чекпоинты делать примерно каждые 400 шагов обучения.
* Добиться приемлемого по качеству результата, сравнить разные чекпоинты (сохраненные после разного количества шагов обучения), выбрать лучший;
* Сделать jupyter notebook c демонстрацией инференаса: 10 сгенерированных стикеров для разных новых (!) описаний, и для трех разных степеней CFG; Всего 30 изображений;
* Итого. Решение должно содержать: 1. Ваш датасет (ссылка на гугл диск), 2. ноутбук с командой запуска тренировки и логом тренировочного процесса, 3. ноутбук с инференсом, сравнением разных чекпоинтов и демнострацией результата

### Рекомендации по генерации датасета
* Старайтесь выбирать не очень сложную тематику стикеров, модель довольно слабая и для сложных картинок может начать генерировать кашу. Надписей на картинках быть не должно
* Выберите ключевое слово (в примере это ski_fail)
* Сгенерируйте таблицу с описаниями с помощью какой-нибудь LLM
* Сгенерируйте картинку для каждого описания, сохраните ее
* Сложите картинки нужной структурой, создайте metadata.jsonl

### Примечание
* Прикладывается тренировачный скрипт для lora stable diffusion 2.1
* Команда для запуска: 

accelerate launch train_text_to_image_lora.py   --pretrained_model_name_or_path=stabilityai/stable-diffusion-2-1   --train_data_dir=my_dataset/   --caption_column=text   --resolution=your_resolution   --random_flip   --train_batch_size=1   --num_train_epochs=220   --checkpointing_steps=300   --learning_rate=your_lr  --lr_scheduler=constant   --lr_warmup_steps=50   --seed=42   --output_dir=tuned-model-lora-ski-fail   --validation_prompt="MY VALIDATION PHRASE" --validation_epochs=25 











